<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëë LIBRUZ PRO - Panel Administratora Systemu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- DODAJ jQuery PRZED Select2 -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        /* STYLE POZOSTAJƒÑ TAKIE SAME - NIE ZMIENIAJ */
        :root {
            --primary: #2c3e50;
            --primary-light: #34495e;
            --secondary: #1abc9c;
            --danger: #e74c3c;
            --warning: #f39c12;
            --info: #3498db;
            --success: #27ae60;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --gray: #95a5a6;
            --border: #bdc3c7;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --radius: 10px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e9f2 100%);
            color: var(--dark);
            min-height: 100vh;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* RESZTA STYL√ìW BEZ ZMIAN - ZACHOWAJ ORYGINALNE STYLE */
        /* ... */
        
    </style>
</head>
<body>
    <!-- MOBILE MENU TOGGLE -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
    </button>

    <div class="app-container">
        <!-- SIDEBAR -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-crown"></i>
                    <span>LIBRUZ PRO</span>
                </div>
            </div>

            <div class="user-panel">
                <div class="user-avatar" id="userAvatar">AD</div>
                <div class="user-name" id="userName">Administrator Systemu</div>
                <div class="user-role">Super Admin</div>
            </div>

            <div class="menu">
                <div class="menu-section">
                    <div class="menu-section-title">G≈Ç√≥wne</div>
                    <a class="menu-item active" id="dashboardMenu">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Pulpit</span>
                    </a>
                    <a class="menu-item" id="schoolsMenu">
                        <i class="fas fa-school"></i>
                        <span>Szko≈Çy</span>
                        <span class="menu-item-badge" id="schoolsCount">0</span>
                    </a>
                    <a class="menu-item" id="usersMenu">
                        <i class="fas fa-users"></i>
                        <span>U≈ºytkownicy</span>
                        <span class="menu-item-badge" id="usersCount">0</span>
                    </a>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">ZarzƒÖdzanie</div>
                    <a class="menu-item" id="classesMenu">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Klasy</span>
                    </a>
                    <a class="menu-item" id="subjectsMenu">
                        <i class="fas fa-book"></i>
                        <span>Przedmioty</span>
                    </a>
                    <a class="menu-item" id="timetableMenu">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Plan Lekcji</span>
                    </a>
                    <a class="menu-item" id="gradesMenu">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Oceny</span>
                    </a>
                    <a class="menu-item" id="attendanceMenu">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Frekwencja</span>
                    </a>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">System</div>
                    <a class="menu-item" id="reportsMenu">
                        <i class="fas fa-chart-bar"></i>
                        <span>Raporty</span>
                    </a>
                    <a class="menu-item" id="backupMenu">
                        <i class="fas fa-database"></i>
                        <span>Backup</span>
                    </a>
                    <a class="menu-item" id="logsMenu">
                        <i class="fas fa-history"></i>
                        <span>Logi Systemowe</span>
                    </a>
                    <a class="menu-item" id="settingsMenu">
                        <i class="fas fa-cogs"></i>
                        <span>Ustawienia</span>
                    </a>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">Wsparcie</div>
                    <a class="menu-item" id="supportMenu">
                        <i class="fas fa-life-ring"></i>
                        <span>Pomoc Techniczna</span>
                    </a>
                    <a class="menu-item" id="logoutMenu">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Wyloguj</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content" id="mainContent">
            <!-- HEADER -->
            <div class="header">
                <div class="header-title">
                    <h1 id="pageTitle">Pulpit administratora</h1>
                    <p id="pageSubtitle">ZarzƒÖdzaj ca≈Çym systemem LIBRUZ PRO</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" id="newSchoolBtn">
                        <i class="fas fa-plus"></i>
                        Nowa szko≈Ça
                    </button>
                    <button class="btn btn-secondary" id="refreshBtn">
                        <i class="fas fa-sync-alt"></i>
                        Od≈õwie≈º
                    </button>
                    <button class="btn btn-info" id="helpBtn">
                        <i class="fas fa-question-circle"></i>
                        Pomoc
                    </button>
                </div>
            </div>

            <!-- DYNAMIC CONTENT -->
            <div id="contentContainer">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <!-- Create School Modal -->
    <div class="modal" id="createSchoolModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-school"></i>
                    Utw√≥rz nowƒÖ szko≈Çƒô
                </div>
                <button class="modal-close" id="closeCreateSchoolModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createSchoolForm">
                    <div class="tabs">
                        <button type="button" class="tab active" id="schoolInfoTab">Dane szko≈Çy</button>
                        <button type="button" class="tab" id="directorInfoTab">Dyrektor</button>
                        <button type="button" class="tab" id="configTab">Konfiguracja</button>
                    </div>

                    <div id="school-info-tab" class="tab-content active">
                        <!-- Form fields remain the same -->
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Nazwa szko≈Çy *</label>
                                <input type="text" class="form-control" id="schoolName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Typ szko≈Çy *</label>
                                <select class="form-control" id="schoolType" required>
                                    <option value="">Wybierz typ</option>
                                    <option value="podstawowa">Szko≈Ça Podstawowa</option>
                                    <option value="liceum">Liceum Og√≥lnokszta≈ÇcƒÖce</option>
                                    <option value="technikum">Technikum</option>
                                    <option value="zawodowa">Szko≈Ça Zawodowa</option>
                                    <option value="branzowa">Szko≈Ça Bran≈ºowa</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Miejscowo≈õƒá *</label>
                                <input type="text" class="form-control" id="schoolCity" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ulica i numer</label>
                                <input type="text" class="form-control" id="schoolAddress">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Kod pocztowy</label>
                                <input type="text" class="form-control" id="schoolPostal" placeholder="00-000">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Telefon kontaktowy</label>
                                <input type="tel" class="form-control" id="schoolPhone">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Email szko≈Çy</label>
                            <input type="email" class="form-control" id="schoolEmail">
                        </div>
                    </div>

                    <div id="director-info-tab" class="tab-content">
                        <!-- Form fields remain the same -->
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            Utworzymy konto dyrektora szko≈Çy z uprawnieniami administracyjnymi.
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Imiƒô dyrektora *</label>
                                <input type="text" class="form-control" id="directorFirstName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nazwisko dyrektora *</label>
                                <input type="text" class="form-control" id="directorLastName" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Email s≈Çu≈ºbowy *</label>
                                <input type="email" class="form-control" id="directorEmail" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Telefon dyrektora</label>
                                <input type="tel" class="form-control" id="directorPhone">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Tymczasowe has≈Ço</label>
                            <div class="d-flex align-center gap-10">
                                <input type="text" class="form-control" id="tempPassword" value="Libruz2024!" readonly>
                                <button type="button" class="btn btn-warning" id="generatePasswordBtn">
                                    <i class="fas fa-redo"></i>
                                </button>
                                <button type="button" class="btn btn-secondary" id="copyPasswordBtn">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="configuration-tab" class="tab-content">
                        <div class="form-group">
                            <label class="form-label">Rok szkolny</label>
                            <select class="form-control" id="academicYear">
                                <option value="2023/2024">2023/2024</option>
                                <option value="2024/2025" selected>2024/2025</option>
                                <option value="2025/2026">2025/2026</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Szablon planu lekcji</label>
                            <select class="form-control" id="timetableTemplate">
                                <option value="">Brak szablonu</option>
                                <option value="basic">Podstawowy (8:00-15:30)</option>
                                <option value="extended">Rozszerzony (7:30-16:30)</option>
                                <option value="shift">System zmianowy</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelSchoolBtn">Anuluj</button>
                <button class="btn btn-success" id="saveSchoolBtn">
                    <i class="fas fa-save"></i>
                    Utw√≥rz szko≈Çƒô
                </button>
            </div>
        </div>
    </div>

    <!-- View School Modal -->
    <div class="modal" id="viewSchoolModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-eye"></i>
                    <span id="modalSchoolTitle">Szko≈Ça</span>
                </div>
                <button class="modal-close" id="closeViewSchoolModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="schoolModalContent">
                    <!-- School details will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Credentials Modal -->
    <div class="modal" id="credentialsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-key"></i>
                    Dane logowania
                </div>
                <button class="modal-close" id="closeCredentialsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="credentialsContent">
                    <!-- Credentials will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="printCredentialsBtn">
                    <i class="fas fa-print"></i>
                    Drukuj
                </button>
                <button class="btn btn-success" id="closeCredentialsBtn">OK</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        // ===== GLOBALNE ZMIENNE =====
        const SUPABASE_URL = 'https://fupfgshptjghdjpkeaee.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ1cGZnc2hwdGpnaGRqcGtlYWVlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1NDk2MTcsImV4cCI6MjA4NTEyNTYxN30.PO_kVi3YBslUH1GQtfSHduMap_oSNYCsGL9eIhpxYnM';
        
        let supabase = null;
        let currentUser = null;
        let currentSection = 'dashboard';
        
        // ===== GLOBALNE FUNKCJE =====
        function openCreateSchoolModal() {
            document.getElementById('createSchoolModal').style.display = 'flex';
            generatePassword();
        }
        
        function logout() {
            if (confirm('Czy na pewno chcesz siƒô wylogowaƒá?')) {
                localStorage.removeItem('libruz_user');
                localStorage.removeItem('libruz_is_logged_in');
                alert('Zosta≈Çe≈õ wylogowany! W rzeczywistej aplikacji nastƒÖpi przekierowanie.');
            }
        }
        
        function loadDashboard() {
            currentSection = 'dashboard';
            updateMenuActiveState();
            
            const content = `
                <!-- STATS -->
                <div class="stats-grid">
                    <div class="stat-card" style="border-top-color: var(--secondary);">
                        <div class="stat-icon" style="background: var(--secondary);">
                            <i class="fas fa-school"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalSchools">5</div>
                            <div class="stat-label">Aktywnych szk√≥≈Ç</div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 2 w tym miesiƒÖcu
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card" style="border-top-color: var(--info);">
                        <div class="stat-icon" style="background: var(--info);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalUsers">1,247</div>
                            <div class="stat-label">U≈ºytkownik√≥w</div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 5.2% wzrost
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card" style="border-top-color: var(--success);">
                        <div class="stat-icon" style="background: var(--success);">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalTeachers">142</div>
                            <div class="stat-label">Nauczycieli</div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 3 nowych
                            </div>
                        </div>
                    </div>
                    
                    <div class="stat-card" style="border-top-color: var(--warning);">
                        <div class="stat-icon" style="background: var(--warning);">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalStudents">3,856</div>
                            <div class="stat-label">Uczni√≥w</div>
                            <div class="stat-trend trend-up">
                                <i class="fas fa-arrow-up"></i> 12.5% wzrost
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- QUICK ACTIONS -->
                <div class="mb-30">
                    <h2 class="card-title mb-20">
                        <i class="fas fa-bolt"></i>
                        Szybkie akcje
                    </h2>
                    <div class="quick-actions">
                        <button class="quick-action-btn" onclick="openCreateSchoolModal()">
                            <i class="fas fa-plus-circle"></i>
                            <span>Nowa szko≈Ça</span>
                        </button>
                        <button class="quick-action-btn" onclick="massResetPasswords()">
                            <i class="fas fa-key"></i>
                            <span>Reset hase≈Ç</span>
                        </button>
                        <button class="quick-action-btn" onclick="exportData()">
                            <i class="fas fa-file-export"></i>
                            <span>Eksport danych</span>
                        </button>
                        <button class="quick-action-btn" onclick="systemBackup()">
                            <i class="fas fa-database"></i>
                            <span>Kopia zapasowa</span>
                        </button>
                        <button class="quick-action-btn" onclick="generateReports()">
                            <i class="fas fa-chart-pie"></i>
                            <span>Raporty</span>
                        </button>
                        <button class="quick-action-btn" onclick="openQuickActionsModal()">
                            <i class="fas fa-cogs"></i>
                            <span>Wiƒôcej akcji</span>
                        </button>
                    </div>
                </div>
                
                <!-- DASHBOARD CARDS -->
                <div class="dashboard-cards">
                    <!-- OSTATNIE AKTYWNO≈öCI -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-history"></i>
                                Ostatnie aktywno≈õci
                            </div>
                            <button class="btn btn-sm btn-secondary" onclick="loadLogs()">
                                Wszystkie
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="activity-timeline">
                                <div class="activity-item">
                                    <div class="activity-icon" style="background: var(--success);">
                                        <i class="fas fa-school"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Dodano nowƒÖ szko≈Çƒô "LO nr 5 w Krakowie"</div>
                                        <div class="activity-time">2 godziny temu</div>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon" style="background: var(--info);">
                                        <i class="fas fa-user-plus"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Nowy nauczyciel zarejestrowany: Anna Kowalska</div>
                                        <div class="activity-time">4 godziny temu</div>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon" style="background: var(--warning);">
                                        <i class="fas fa-key"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Reset has≈Ça dla dyrektora SP1 Warszawa</div>
                                        <div class="activity-time">1 dzie≈Ñ temu</div>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon" style="background: var(--secondary);">
                                        <i class="fas fa-database"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Kopia zapasowa wykonana pomy≈õlnie</div>
                                        <div class="activity-time">2 dni temu</div>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon" style="background: var(--primary);">
                                        <i class="fas fa-chart-bar"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Raport miesiƒôczny wygenerowany</div>
                                        <div class="activity-time">3 dni temu</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SYSTEM STATUS -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-heartbeat"></i>
                                Status systemu
                            </div>
                            <span class="badge badge-success">Online</span>
                        </div>
                        <div class="card-body">
                            <div class="system-status">
                                <div class="status-item">
                                    <span>Baza danych:</span>
                                    <span class="badge badge-success">Aktywna</span>
                                </div>
                                <div class="status-item">
                                    <span>Pamiƒôƒá serwera:</span>
                                    <div class="d-flex align-center gap-10">
                                        <div class="progress-bar" style="flex: 1;">
                                            <div class="progress-bar-fill" style="width: 65%;"></div>
                                        </div>
                                        <span>65%</span>
                                    </div>
                                </div>
                                <div class="status-item">
                                    <span>Ostatni backup:</span>
                                    <span>${new Date().toLocaleDateString('pl-PL')}</span>
                                </div>
                                <div class="status-item">
                                    <span>B≈Çƒôdy systemowe (24h):</span>
                                    <span class="badge badge-success">0 b≈Çƒôd√≥w</span>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-primary mt-20 w-100" onclick="systemDiagnostics()">
                                <i class="fas fa-stethoscope"></i>
                                Uruchom diagnostykƒô
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- OSTATNIE SZKO≈ÅY -->
                <div class="card mt-30">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-school"></i>
                            Ostatnio dodane szko≈Çy
                        </div>
                        <button class="btn btn-sm btn-primary" onclick="loadSchools()">
                            Wszystkie szko≈Çy
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="schools-list">
                            <div class="school-card">
                                <div class="school-card-header">
                                    <div class="school-card-title">
                                        <i class="fas fa-school"></i>
                                        Liceum Og√≥lnokszta≈ÇcƒÖce nr 5
                                    </div>
                                    <span class="badge badge-info">Krak√≥w</span>
                                </div>
                                <p>ul. Szkolna 15, 30-123 Krak√≥w</p>
                                <div class="school-card-stats">
                                    <div class="school-stat">
                                        <div class="school-stat-value">24</div>
                                        <div class="school-stat-label">Nauczycieli</div>
                                    </div>
                                    <div class="school-stat">
                                        <div class="school-stat-value">420</div>
                                        <div class="school-stat-label">Uczni√≥w</div>
                                    </div>
                                    <div class="school-stat">
                                        <div class="school-stat-value">16</div>
                                        <div class="school-stat-label">Klas</div>
                                    </div>
                                    <div class="school-stat">
                                        <div class="school-stat-value">${new Date().toLocaleDateString('pl-PL')}</div>
                                        <div class="school-stat-label">Data dodania</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('contentContainer').innerHTML = content;
            document.getElementById('pageTitle').textContent = 'Pulpit administratora';
            document.getElementById('pageSubtitle').textContent = 'PrzeglƒÖd ca≈Çego systemu LIBRUZ PRO';
            
            // Za≈Çaduj dane
            loadDashboardData();
        }
        
        function loadSchools() {
            currentSection = 'schools';
            updateMenuActiveState();
            
            const content = `
                <div class="d-flex justify-between align-center mb-30">
                    <h2 class="card-title">
                        <i class="fas fa-school"></i>
                        ZarzƒÖdzanie szko≈Çami
                    </h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openCreateSchoolModal()">
                            <i class="fas fa-plus"></i>
                            Nowa szko≈Ça
                        </button>
                        <button class="btn btn-secondary" onclick="exportSchools()">
                            <i class="fas fa-download"></i>
                            Eksportuj
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Nazwa szko≈Çy</th>
                                        <th>Typ</th>
                                        <th>Miejscowo≈õƒá</th>
                                        <th>Adres</th>
                                        <th>Telefon</th>
                                        <th>Utworzono</th>
                                        <th>Akcje</th>
                                    </tr>
                                </thead>
                                <tbody id="schoolsTableBody">
                                    <tr>
                                        <td><strong>Szko≈Ça Podstawowa nr 1</strong></td>
                                        <td><span class="badge badge-info">podstawowa</span></td>
                                        <td>Warszawa</td>
                                        <td>ul. Szkolna 1</td>
                                        <td>22 123 45 67</td>
                                        <td>2024-01-15</td>
                                        <td>
                                            <div class="d-flex gap-10">
                                                <button class="btn btn-sm btn-info" onclick="viewSchoolDetails(1)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-sm btn-warning" onclick="editSchool(1)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-sm btn-danger" onclick="deleteSchool(1)">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Liceum Og√≥lnokszta≈ÇcƒÖce nr 3</strong></td>
                                        <td><span class="badge badge-info">liceum</span></td>
                                        <td>Krak√≥w</td>
                                        <td>ul. Akademicka 5</td>
                                        <td>12 345 67 89</td>
                                        <td>2024-01-10</td>
                                        <td>
                                            <div class="d-flex gap-10">
                                                <button class="btn btn-sm btn-info" onclick="viewSchoolDetails(2)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-sm btn-warning" onclick="editSchool(2)">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-sm btn-danger" onclick="deleteSchool(2)">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('contentContainer').innerHTML = content;
            document.getElementById('pageTitle').textContent = 'ZarzƒÖdzanie szko≈Çami';
            document.getElementById('pageSubtitle').textContent = 'PrzeglƒÖdaj i zarzƒÖdzaj wszystkimi szko≈Çami';
        }
        
        function loadUsers() {
            currentSection = 'users';
            updateMenuActiveState();
            
            const content = `
                <div class="d-flex justify-between align-center mb-30">
                    <h2 class="card-title">
                        <i class="fas fa-users"></i>
                        ZarzƒÖdzanie u≈ºytkownikami
                    </h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="addNewUser()">
                            <i class="fas fa-user-plus"></i>
                            Nowy u≈ºytkownik
                        </button>
                        <button class="btn btn-secondary" onclick="exportUsers()">
                            <i class="fas fa-download"></i>
                            Eksportuj
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Imiƒô i nazwisko</th>
                                        <th>Email</th>
                                        <th>Rola</th>
                                        <th>Szko≈Ça</th>
                                        <th>Status</th>
                                        <th>Ostatnie logowanie</th>
                                        <th>Akcje</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Jan Kowalski</strong></td>
                                        <td>dyrektor@sp1.pl</td>
                                        <td><span class="badge badge-info">Dyrektor</span></td>
                                        <td>SP1 Warszawa</td>
                                        <td><span class="badge badge-success">Aktywny</span></td>
                                        <td>2024-03-15 14:30</td>
                                        <td>
                                            <div class="d-flex gap-10">
                                                <button class="btn btn-sm btn-info" onclick="viewUser(1)">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                                <button class="btn btn-sm btn-warning" onclick="resetUserPassword(1)">
                                                    <i class="fas fa-key"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('contentContainer').innerHTML = content;
            document.getElementById('pageTitle').textContent = 'ZarzƒÖdzanie u≈ºytkownikami';
            document.getElementById('pageSubtitle').textContent = 'PrzeglƒÖdaj i zarzƒÖdzaj u≈ºytkownikami systemu';
        }
        
        // ===== POZOSTA≈ÅE FUNKCJE =====
        // Przyk≈Çadowe inne funkcje
        function loadClasses() {
            currentSection = 'classes';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>ZarzƒÖdzanie klasami</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadSubjects() {
            currentSection = 'subjects';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>ZarzƒÖdzanie przedmiotami</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadTimetable() {
            currentSection = 'timetable';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>Plan lekcji</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadGrades() {
            currentSection = 'grades';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>System oceniania</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadAttendance() {
            currentSection = 'attendance';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>System frekwencji</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadReports() {
            currentSection = 'reports';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>Raporty</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadBackup() {
            currentSection = 'backup';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>Backup systemu</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadLogs() {
            currentSection = 'logs';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>Logi systemowe</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadSettings() {
            currentSection = 'settings';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>Ustawienia systemu</h2><p>Funkcja w budowie...</p>';
        }
        
        function loadSupport() {
            currentSection = 'support';
            updateMenuActiveState();
            document.getElementById('contentContainer').innerHTML = '<h2>Pomoc techniczna</h2><p>Funkcja w budowie...</p>';
        }
        
        function refreshData() {
            showSuccess('Dane zosta≈Çy od≈õwie≈ºone');
            if (currentSection === 'dashboard') {
                loadDashboard();
            } else if (currentSection === 'schools') {
                loadSchools();
            }
        }
        
        function showQuickHelp() {
            alert('Pomoc: Skontaktuj siƒô z administratorem pod adresem admin@libruz.pl');
        }
        
        function generatePassword() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789!@#$%';
            let password = '';
            for (let i = 0; i < 12; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('tempPassword').value = password;
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function updateMenuActiveState() {
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            if (currentSection === 'dashboard') {
                document.querySelector('#dashboardMenu').classList.add('active');
            } else if (currentSection === 'schools') {
                document.querySelector('#schoolsMenu').classList.add('active');
            } else if (currentSection === 'users') {
                document.querySelector('#usersMenu').classList.add('active');
            } else if (currentSection === 'classes') {
                document.querySelector('#classesMenu').classList.add('active');
            } else if (currentSection === 'subjects') {
                document.querySelector('#subjectsMenu').classList.add('active');
            } else if (currentSection === 'timetable') {
                document.querySelector('#timetableMenu').classList.add('active');
            } else if (currentSection === 'grades') {
                document.querySelector('#gradesMenu').classList.add('active');
            } else if (currentSection === 'attendance') {
                document.querySelector('#attendanceMenu').classList.add('active');
            } else if (currentSection === 'reports') {
                document.querySelector('#reportsMenu').classList.add('active');
            } else if (currentSection === 'backup') {
                document.querySelector('#backupMenu').classList.add('active');
            } else if (currentSection === 'logs') {
                document.querySelector('#logsMenu').classList.add('active');
            } else if (currentSection === 'settings') {
                document.querySelector('#settingsMenu').classList.add('active');
            } else if (currentSection === 'support') {
                document.querySelector('#supportMenu').classList.add('active');
            }
        }
        
        function showSuccess(message) {
            alert('‚úÖ ' + message);
        }
        
        function showError(message) {
            alert('‚ùå ' + message);
        }
        
        function viewSchoolDetails(id) {
            const school = id === 1 ? {
                name: 'Szko≈Ça Podstawowa nr 1',
                type: 'podstawowa',
                city: 'Warszawa',
                address: 'ul. Szkolna 1',
                postal: '00-001',
                phone: '22 123 45 67',
                email: 'sekretariat@sp1.pl',
                director: 'Jan Kowalski',
                teachers: 32,
                students: 450,
                classes: 18
            } : {
                name: 'Liceum Og√≥lnokszta≈ÇcƒÖce nr 3',
                type: 'liceum',
                city: 'Krak√≥w',
                address: 'ul. Akademicka 5',
                postal: '30-123',
                phone: '12 345 67 89',
                email: 'kontakt@lo3.pl',
                director: 'Anna Nowak',
                teachers: 24,
                students: 420,
                classes: 16
            };
            
            const content = `
                <div class="school-card">
                    <div class="school-card-header">
                        <div class="school-card-title">
                            <i class="fas fa-school"></i>
                            ${school.name}
                        </div>
                        <span class="badge badge-info">${school.type}</span>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Adres:</label>
                        <p>${school.address}, ${school.postal} ${school.city}</p>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Telefon:</label>
                            <p>${school.phone}</p>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email:</label>
                            <p>${school.email}</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Dyrektor:</label>
                        <p>${school.director}</p>
                    </div>
                    
                    <div class="school-card-stats">
                        <div class="school-stat">
                            <div class="school-stat-value">${school.teachers}</div>
                            <div class="school-stat-label">Nauczycieli</div>
                        </div>
                        <div class="school-stat">
                            <div class="school-stat-value">${school.students}</div>
                            <div class="school-stat-label">Uczni√≥w</div>
                        </div>
                        <div class="school-stat">
                            <div class="school-stat-value">${school.classes}</div>
                            <div class="school-stat-label">Klas</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('modalSchoolTitle').textContent = school.name;
            document.getElementById('schoolModalContent').innerHTML = content;
            document.getElementById('viewSchoolModal').style.display = 'flex';
        }
        
        function editSchool(id) {
            alert('Edycja szko≈Çy ID: ' + id + ' - funkcja w budowie');
        }
        
        function deleteSchool(id) {
            if (confirm('Czy na pewno chcesz usunƒÖƒá tƒô szko≈Çƒô?')) {
                showSuccess('Szko≈Ça zosta≈Ça usuniƒôta');
            }
        }
        
        // ===== INICJALIZACJA =====
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ LIBRUZ PRO - Panel Administratora');
            
            // Inicjalizuj mobile menu
            document.getElementById('mobileMenuToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
            });
            
            // Inicjalizuj Supabase
            try {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                console.log('‚úÖ Supabase zainicjalizowany');
            } catch (error) {
                console.error('‚ùå B≈ÇƒÖd inicjalizacji Supabase:', error);
            }
            
            // Ustaw dane u≈ºytkownika
            currentUser = {
                first_name: 'Administrator',
                last_name: 'Systemu',
                email: 'admin@libruz.pl',
                role: 'admin'
            };
            
            // Dodaj event listeners do menu
            document.getElementById('dashboardMenu').addEventListener('click', loadDashboard);
            document.getElementById('schoolsMenu').addEventListener('click', loadSchools);
            document.getElementById('usersMenu').addEventListener('click', loadUsers);
            document.getElementById('classesMenu').addEventListener('click', loadClasses);
            document.getElementById('subjectsMenu').addEventListener('click', loadSubjects);
            document.getElementById('timetableMenu').addEventListener('click', loadTimetable);
            document.getElementById('gradesMenu').addEventListener('click', loadGrades);
            document.getElementById('attendanceMenu').addEventListener('click', loadAttendance);
            document.getElementById('reportsMenu').addEventListener('click', loadReports);
            document.getElementById('backupMenu').addEventListener('click', loadBackup);
            document.getElementById('logsMenu').addEventListener('click', loadLogs);
            document.getElementById('settingsMenu').addEventListener('click', loadSettings);
            document.getElementById('supportMenu').addEventListener('click', loadSupport);
            document.getElementById('logoutMenu').addEventListener('click', logout);
            
            // Dodaj event listeners do przycisk√≥w
            document.getElementById('newSchoolBtn').addEventListener('click', openCreateSchoolModal);
            document.getElementById('refreshBtn').addEventListener('click', refreshData);
            document.getElementById('helpBtn').addEventListener('click', showQuickHelp);
            
            // Dodaj event listeners do modal√≥w
            document.getElementById('closeCreateSchoolModal').addEventListener('click', () => closeModal('createSchoolModal'));
            document.getElementById('cancelSchoolBtn').addEventListener('click', () => closeModal('createSchoolModal'));
            document.getElementById('closeViewSchoolModal').addEventListener('click', () => closeModal('viewSchoolModal'));
            document.getElementById('closeCredentialsModal').addEventListener('click', () => closeModal('credentialsModal'));
            document.getElementById('closeCredentialsBtn').addEventListener('click', () => closeModal('credentialsModal'));
            
            // Dodaj event listeners do formularza szko≈Çy
            document.getElementById('generatePasswordBtn').addEventListener('click', generatePassword);
            document.getElementById('copyPasswordBtn').addEventListener('click', function() {
                const passwordField = document.getElementById('tempPassword');
                passwordField.select();
                navigator.clipboard.writeText(passwordField.value);
                showSuccess('Has≈Ço skopiowane do schowka');
            });
            
            document.getElementById('saveSchoolBtn').addEventListener('click', function() {
                const schoolName = document.getElementById('schoolName').value;
                if (schoolName) {
                    showSuccess(`Szko≈Ça "${schoolName}" utworzona pomy≈õlnie!`);
                    closeModal('createSchoolModal');
                } else {
                    showError('Wprowad≈∫ nazwƒô szko≈Çy');
                }
            });
            
            // Dodaj event listeners do zak≈Çadek
            document.getElementById('schoolInfoTab').addEventListener('click', function() {
                switchTab('school-info');
            });
            document.getElementById('directorInfoTab').addEventListener('click', function() {
                switchTab('director-info');
            });
            document.getElementById('configTab').addEventListener('click', function() {
                switchTab('configuration');
            });
            
            // Za≈Çaduj dashboard
            loadDashboard();
            
            console.log('‚úÖ System zainicjalizowany pomy≈õlnie');
        });
        
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all tab buttons
            document.querySelectorAll('.tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Find and activate the corresponding tab button
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                if (tab.id && tab.id.includes(tabName.split('-')[0])) {
                    tab.classList.add('active');
                }
            });
        }
        
        function loadDashboardData() {
            document.getElementById('schoolsCount').textContent = '5';
            document.getElementById('usersCount').textContent = '1,247';
        }
        
        // Przyk≈Çadowe funkcje pomocnicze
        function massResetPasswords() {
            if (confirm('Resetowaƒá has≈Ça dla wszystkich u≈ºytkownik√≥w?')) {
                showSuccess('Has≈Ça zosta≈Çy zresetowane');
            }
        }
        
        function exportData() {
            alert('Eksport danych rozpoczƒôty');
        }
        
        function systemBackup() {
            alert('Tworzenie kopii zapasowej...');
        }
        
        function generateReports() {
            loadReports();
        }
        
        function openQuickActionsModal() {
            alert('Otwieranie szybkich akcji...');
        }
        
        function systemDiagnostics() {
            alert('Uruchamianie diagnostyki...');
        }
        
        function exportSchools() {
            alert('Eksport szk√≥≈Ç...');
        }
        
        function exportUsers() {
            alert('Eksport u≈ºytkownik√≥w...');
        }
        
        function addNewUser() {
            alert('Dodawanie nowego u≈ºytkownika...');
        }
        
        function viewUser(id) {
            alert('PodglƒÖd u≈ºytkownika ID: ' + id);
        }
        
        function resetUserPassword(id) {
            showSuccess('Has≈Ço u≈ºytkownika zresetowane');
        }
    </script>
</body>
</html>
